<launch>
  <arg name="world_name" default="clearpath_playpen" />
  <include file="$(find fifth_robot_description)/launch/gazebo/setup_gazebo.launch">
    <arg name="rviz" value="false" />
    <arg name="world_name" value="$(arg world_name)" />
  </include>
  
  <arg name="2d_mapfile" default="$(find fifth_robot_description)/map/sample_map.yaml" />
  <node pkg="map_server" type="map_server" name="map_server" args="$(arg 2d_mapfile)" />

  <arg name="localization" default="amcl" />
  <group if="$(eval localization == 'amcl')">
    <include file="$(find fifth_robot_description)/launch/rosbag/pointcloud_to_laserscan.launch" />  
    <include file="$(find fifth_robot_description)/launch/navigation/amcl_diff_gazebo.launch" />
    <node pkg="rviz" type="rviz" name="rviz" required="true"
          args="-d $(find fifth_robot_description)/rviz/gazebo_3d_with_amcl.rviz" />
  </group>
  
  <group if="$(eval localization == 'mcl_3dl')">
    <arg name="3d_mapfile" default="$(find fifth_robot_description)/map/3d_map.pcd" />
    <include file="$(find fifth_robot_description)/launch/navigation/mcl_3dl_gazebo.launch">
      <arg name="mapfile" value="$(arg 3d_mapfile)" />
    </include>
    <node pkg="rviz" type="rviz" name="rviz" required="true"
          args="-d $(find fifth_robot_description)/rviz/gazebo_3d_with_mcl_3dl.rviz" />
  </group>

  <include file="$(find fifth_robot_description)/launch/navigation/move_base_gazebo.launch" />

</launch>
